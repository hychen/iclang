#!/usr/bin/env lsc
require! program: commander
require! path
{filter} = require 'prelude-ls'

program
  .version (require require.resolve \../package.json).version
  .description 'list running processes.'

args = program.parse process.argv

require! forever
err, processes <- forever.list false
throw err if err
if processes
  icprocesses = filter ((proc) -> 'ic-node-process' == path.basename proc.command), processes
  console.log forever.format true, icprocesses
else
  console.log "No iclang processes running"